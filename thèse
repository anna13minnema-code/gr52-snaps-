### **1Ô∏è‚É£ Structure compl√®te du projet**

```
/ (racine du repo)
‚îú‚îÄ index.html
‚îú‚îÄ app.js
‚îú‚îÄ style.css
‚îú‚îÄ manifest.json
‚îú‚îÄ service-worker.js
‚îú‚îÄ _redirects
‚îú‚îÄ netlify.toml
‚îú‚îÄ package.json
‚îú‚îÄ functions/
‚îÇ   ‚îî‚îÄ upload-photo.js
‚îî‚îÄ icons/
    ‚îú‚îÄ icon-192.png
    ‚îî‚îÄ icon-512.png
```

> Les fichiers `icon-192.png` et `icon-512.png` doivent exister. Tu peux mettre tes propres ic√¥nes ou t√©l√©charger des images PWA temporaires pour tester.

---

### **2Ô∏è‚É£ `index.html`**

```html
<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GR52 Snaps</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <main class="container">
    <header>
      <h1>GR52 Snaps</h1>
      <p>Point : <strong id="point-id"></strong></p>
    </header>

    <section>
      <div class="preview-wrap">
        <img id="preview" />
      </div>

      <input id="file-input" type="file" accept="image/*" capture="environment" hidden />
      <button id="take-photo">üì∏ Prendre une photo</button>
      <button id="choose-photo">üñºÔ∏è Choisir une photo</button>
      <button id="send-photo" disabled>üì§ Envoyer</button>

      <p id="status"></p>
      <div id="log"></div>
    </section>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="app.js"></script>

  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js');
    }
  </script>
</body>
</html>
```

---

### **3Ô∏è‚É£ `app.js`**

```javascript
const SUPABASE_URL = 'VOTRE_SUPABASE_URL';
const SUPABASE_KEY = 'VOTRE_SUPABASE_SERVICE_KEY';

const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

const pointId = new URLSearchParams(window.location.search).get('point') || 'unknown';
document.getElementById('point-id').textContent = pointId;

const fileInput = document.getElementById('file-input');
const takePhotoBtn = document.getElementById('take-photo');
const choosePhotoBtn = document.getElementById('choose-photo');
const sendPhotoBtn = document.getElementById('send-photo');
const previewImg = document.getElementById('preview');
const statusP = document.getElementById('status');

let currentFile = null;

takePhotoBtn.addEventListener('click', () => fileInput.click());
choosePhotoBtn.addEventListener('click', () => fileInput.click());

fileInput.addEventListener('change', (e) => {
  const file = e.target.files[0];
  if (!file) return;
  currentFile = file;
  previewImg.src = URL.createObjectURL(file);
  sendPhotoBtn.disabled = false;
});

sendPhotoBtn.addEventListener('click', async () => {
  if (!currentFile) return;
  statusP.textContent = 'Envoi en cours...';

  const formData = new FormData();
  formData.append('photo', currentFile);
  formData.append('point_id', pointId);

  try {
    const res = await fetch('/.netlify/functions/upload-photo', {
      method: 'POST',
      body: formData
    });

    const data = await res.json();
    if (res.ok) statusP.textContent = 'Photo envoy√©e !';
    else statusP.textContent = 'Erreur : ' + data.error;

  } catch (err) {
    statusP.textContent = 'Erreur r√©seau';
    console.error(err);
  }
});
```

---

### **4Ô∏è‚É£ `style.css`**

```css
body {
  font-family: Arial, sans-serif;
  padding: 20px;
  background: #f5f5f5;
}

.container {
  max-width: 600px;
  margin: auto;
}

.preview-wrap img {
  width: 100%;
  margin: 10px 0;
}
```

---

### **5Ô∏è‚É£ `manifest.json`**

```json
{
  "name": "GR52 Snaps",
  "short_name": "GR52",
  "start_url": "/",
  "display": "standalone",
  "theme_color": "#559c87ff",
  "background_color": "#ffffff",
  "icons": [
    { "src": "icons/icon-192.png", "sizes": "192x192", "type": "image/png" },
    { "src": "icons/icon-512.png", "sizes": "512x512", "type": "image/png" }
  ]
}
```

---

### **6Ô∏è‚É£ `service-worker.js`**

```javascript
self.addEventListener('install', () => {
  console.log('Service Worker install√©');
  self.skipWaiting();
});

self.addEventListener('activate', () => {
  console.log('Service Worker activ√©');
});

self.addEventListener('fetch', () => {});
```

---

### **7Ô∏è‚É£ `netlify.toml`**

```toml
[build]
  publish = "."
  functions = "functions"

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
```

---

### **8Ô∏è‚É£ `_redirects`**

```
/*    /index.html   200
```

---

### **9Ô∏è‚É£ `package.json`**

```json
{
  "name": "gr52-snaps",
  "version": "1.0.0",
  "type": "commonjs",
  "dependencies": {
    "@supabase/supabase-js": "^2.40.0",
    "busboy": "^1.6.0"
  },
  "scripts": {
    "start": "echo 'Nothing to build, just serving static files'",
    "build": "echo 'Nothing to build, just serving static files'"
  }
}
```

---

### **10Ô∏è‚É£ `functions/upload-photo.js`**

Identique √† ton code actuel, √† condition que les variables d‚Äôenvironnement soient configur√©es sur Netlify (`SUPABASE_URL`, `SUPABASE_SERVICE_KEY`, `SUPABASE_BUCKET`).

---

### ‚úÖ **Instructions finales**

1. Copier-coller la structure compl√®te dans ton d√©p√¥t GitHub.
2. Ajouter les variables d‚Äôenvironnement Supabase dans Netlify.
3. Pousser sur GitHub et laisser Netlify reconstruire le site.
4. Tester en local avec‚ÄØ:

```bash
netlify dev
```

Apr√®s √ßa, ton site devrait **s‚Äôafficher correctement** et les fonctions Netlify devraient √™tre op√©rationnelles.

---

Si tu veux, je peux te faire un **sch√©ma visuel simple** de la structure du projet et de la relation `Netlify ‚Üí functions ‚Üí Supabase`, pour que tout soit clair et √©viter tout futur probl√®me de d√©ploiement.

Veux‚Äëtu que je fasse √ßa‚ÄØ?
